<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta tags  -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />

    
    <title>Speedlink</title>
    <link rel="icon" type="image/png" href="../images/favicon.png" />

    <!-- CSS Assets -->
    <link rel="stylesheet" href="../css/output.css" />
    <link rel="stylesheet" href="../css/app.css" />
    <link rel="stylesheet" href="../css/w3.css" />
    <link rel="stylesheet" href="../css/pond.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <!-- Include FilePond CSS -->
  <link href="https://unpkg.com/filepond@5.0.12/dist/filepond.min.css" rel="stylesheet">
    <!-- Javascript Assets -->
    <script src="../js/app.js" defer></script>
    <script src="../js/jquery.js"></script>
    <script src="../js/w3.js" ></script>
    <script src="../js/pond.js" ></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
  </head>

  <body x-data class="is-header-blur" x-bind="$store.global.documentBody">
    <!-- App preloader-->
    <div
      class="app-preloader fixed z-50 grid h-full w-full place-content-center bg-slate-50 dark:bg-navy-900"
    >
      <div class="app-preloader-inner relative inline-block h-48 w-48"></div>
    </div>

    <!-- Page Wrapper -->
    <div
      id="root"
      class="min-h-100vh flex grow bg-slate-50 dark:bg-navy-900"
      x-cloak
    >


      <!-- App Header Wrapper-->
      <nav class="header print:hidden bg-red-00">
        <!-- App Header  -->
        <div
          class="header-container relative flex w-full bg-white dark:bg-navy-750 print:hidden"
        >
          <!-- Header Items -->
          <div class="flex w-full items-center justify-between">
            <!-- Left: Sidebar Toggle Button -->
            <div class="h-7 w-11">
              <button
                class=" menu-toggle ml-0.5 flex h-7 w-7 flex-col justify-center space-y-1.5 text-primary outline-none focus:outline-none dark:text-accent-light/80"
              
              >
                lOGO
              </button>
            </div>

  
              <div class="h-7 w-28">
                <button
                  class=" menu-toggle ml-0.5 flex h-7 w-7 flex-col justify-center space-y-1.5 text-primary outline-none focus:outline-none dark:text-accent-light/80"
                  :class="$store.global.isSidebarExpanded && 'active'"
                  @click="$store.global.isSidebarExpanded = !$store.global.isSidebarExpanded"
                >
                  <span></span>
                  <span></span>
                  <span></span>
                </button>
              </div>
             
        


            
            <!-- Right: Header buttons -->
            <div class=" flex items-center justify- space-x-2 w-full  px-4">
 
                    <!-- Dark Mode Toggle -->
                    <button
                        @click="$store.global.isDarkModeEnabled = !$store.global.isDarkModeEnabled"
                        class="btn h-8 w-fit rounded-full px-10 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
                    >
                    How it works
                    </button>

                    <button
                    @click="$store.global.isDarkModeEnabled = !$store.global.isDarkModeEnabled"
                    class="btn h-8 w-fix rounded-full px-10 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
                    >
                
                    Features
                    </button>

                    <button
                    @click="$store.global.isDarkModeEnabled = !$store.global.isDarkModeEnabled"
                    class="btn h-8 w-fit rounded-full px-10 hover:bg-slate-300/20 focus:bg-slate-300/20 active:bg-slate-300/25 dark:hover:bg-navy-300/20 dark:focus:bg-navy-300/20 dark:active:bg-navy-300/25"
                >
                
                    Pricing
                </button>

            </div>

          </div>
        </div>
      </nav>



            <!-- Main Content Wrapper -->
            <main
            class="main-content w-full place-items-center px-[var(--margin-x)] pb-12"
          >

              <div class="w-full h-fit p-4 text-center  dark:text-white relative top-4 text-3xl " id="upload_title">
                <h2 class="up_title">TITLE</h2>
            </div>
              <div class="w-full h-fit p-4 text-center relative top-4 text-base hidden">
                <h2 class="uo_desc">Description</h2>
            </div>
      
            <div class="grid grid-cols-12 gap-4 sm:gap-5 lg:gap-6 mt-5">
              <div class="col-span-12 grid lg:col-span-7 sm:col-span-8">
                <div class="card">
                  <div
                    class="border-b border-slate-200 p-4 dark:border-navy-500 sm:px-5"
                  >
                    <div class="flex items-center space-x-2">
                      <div
                        class="flex h-7 w-7 items-center justify-center rounded-lg bg-primary/10 p-1 text-primary dark:bg-accent-light/10 dark:text-accent-light"
                      >
                        <i class="fa-solid fa-layer-group"></i>
                      </div>
                      <h4
                        class="text-lg font-medium text-slate-700 dark:text-navy-100"
                      >
                        Upload File
                      </h4>
                    </div>
                  </div>
                  <div class="space-y-4 p-4 sm:p-5">
                    <label class="block">
                      <span>Your Name</span>
    
                      <input
                        class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"
                        placeholder="Your FullName"
                        id="upload_name"
                        type="text"
                        value="iso divine"
                      />
                      <span id="up_name_err" class="text-red-400"></span>
                    </label>
                    <label class="block">
                      <span>Your Email</span>
    
                      <input
                        class="form-input mt-1.5 w-full rounded-lg border border-slate-300 bg-transparent px-3 py-2 placeholder:text-slate-400/70 hover:border-slate-400 focus:border-primary dark:border-navy-450 dark:hover:border-navy-400 dark:focus:border-accent"
                        placeholder="Your Email"
                        id="upload_email"
                        type="text"
                        value="iso@gmail.com"
                      />
                      <span id="up_email_err" class="text-red-400"></span>
                    </label>
                    <div class="flex justify-center space-x-2 pt-4" id="next_section" style="display: block;">
                      
                      <button
                      onclick="next()"
                        class="btn space-x-2 bg-primary font-medium text-white hover:bg-primary-focus focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                      >
                        <span>Next</span>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M3 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062A1.125 1.125 0 013 16.81V8.688zM12.75 8.688c0-.864.933-1.405 1.683-.977l7.108 4.062a1.125 1.125 0 010 1.953l-7.108 4.062a1.125 1.125 0 01-1.683-.977V8.688z" />
                        </svg>
                        
                      </button>
                    </div>
                    <!-- IMAGE SECTION  -->
            
                
                    <div class="" id="image_section" style="display: none;">
                      <span>Images</span>
                      <div
                        class="filepond fp-bordered fp-grid mt-1.5 [--fp-grid:2]"
                      >
                        <input
                          type="file"   
                          class="file"
                          name="file"
                          id="filepond" 
                          
                          
                        />
                      </div>
                    </div>
                    </form>
                    <!-- PROGRESS BAR START -->
                    <div id="progress_bar_section" style="display: none;">
                      <div class="flex">
                        <div class="mr-3 font-medium dark:text-white  flex items-center text-slate-800 " id="upload_percentage">0%</div>
                        <div id="result" style="display: none;" class="flex items-center text-red-500 dark:text-red-500 offline ">
                          <i class="bi bi-wifi-off" style="font-size: 20px;"></i>                 
                          <span>Seems you are offline, Dont leave this page </span>
                        </div>
                      </div>

                      <div class="progress h-2 bg-slate-150 dark:bg-navy-500">
                        <div class="is-active relative overflow-hidden rounded-full bg-warning progress_bar">

                        </div>
                      </div>
                    </div>
                    <!-- UPLOAD BUTTON FLEX -->
                    <div class="flex justify-start space-x-2 pt-4" id="upload_button" style="display:none;">
                      
                      <button
                      onclick="uploadToDrive()"
                        class="btn space-x-2 bg-primary font-medium text-white hover:bg-primary-focus focus:bg-primary-focus active:bg-primary-focus/90 dark:bg-accent dark:hover:bg-accent-focus dark:focus:bg-accent-focus dark:active:bg-accent/90"
                      >
                        <span>Upload</span>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" />
                        </svg>
                        <div id="up_spinner" style="display: none;" class="spinner is-elastic h-7 w-7 animate-spin rounded-full border-[3px] border-white border-r-transparent dark:border-white dark:border-r-transparent">
                        </div>
                        
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="relative border rounded-lg md:border-slate-700 col-span-12 grid lg:col-span5 sm:col-span-4 lg: sm: p-4  border-slate-700">
                <div>
                  <div class="mt-2 text-2xl text- dark:text-white">Upload Description </div>
                  <div class="mt-4 text-base text- up_desc"  id="upload_description"></div>

                  <div class="text-base"></div>
                </div>
              </div>
            </div>
          </main>


    </div>
    <!-- 
        This is a place for Alpine.js Teleport feature 
        @see https://alpinejs.dev/directives/teleport
      -->
    <div id="x-teleport-target"></div>
    <script>
      window.addEventListener("DOMContentLoaded", () => Alpine.start());
    </script>
  </body>
</html>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
 
  const fd = new FormData();
  // Find the input element
  const inputElements = document.getElementById('filepond');

  // Initialize FilePond
  const ponds = FilePond.create(inputElements, {
    allowMultiple:true,
    instantUpload:true,
    allowProcess:false
    // Configuration options go here
  });


  // Listen for the 'addfile' event
  ponds.on('addfile', (error, file) => {
    if (!error) {
      const firstFile = file;
    } else {
      // Handle the error
      console.error('Error adding file:', error);
    }
  });

  function uploadToDrive(){
    const uploadedFiles = ponds.getFiles();


    console.log('loop')
    for (var i = 0; i < uploadedFiles.length; i++){   
      console.log(uploadedFiles[i].source)
    }

    // BLOB
  
    let selectedFile = uploadedFiles[0].source

         // Resume an upload after it failed due to network issues
        function checkResume(header_res, size) {
          let url = ''
          let range = ''
        
          //  Set interval to keep checking to see if the chunk_status has changes  
          const intervalId = setInterval(function() {     
            resume()
          }, 3000)
        
          async function resume(){
            if (navigator.onLine) {
              if(localStorage.getItem('loc_url') !== null){
                url = header_res
              }
              console.log('url'+url)

              try {            
                const response = await fetch(header_res, {
                    method: 'PUT',
                    headers: { 
                      "Content-Range": `bytes */${size}`,
                      "Content-Length": '0'
                    }
                });
                let status_ = await response.status
                let headers = await response.headers.get('range'); 
               
                console.log(status_)
                console.log(headers)
                 if(headers == null){
                  range = null
                  uploadfile(url, selectedFile, range)
                 }
                if(status_ == 308){
                  let ranges = headers
                  let parts = ranges.split("-");
                  if (parts.length === 2) {
                    range = parts[1];               
                  } else {
                    console.log('Invalid format');
                  }
     
                  console.log('new range is:'+range)
                  uploadfile(url, selectedFile, range)
                  clearInterval(intervalId);
                }
                if(status_ == 200){
                  updateProgressBar('complete')
                  console.log('upload complete')
                  clearInterval(intervalId);
                }
                  clearInterval(intervalId);
                
              }catch(err){
                console.log(err)
              }
            
            } else {
              console.log('You are offline.');
            } 
          }
  
        }
    
    
    



  
  const getlocations = async (selectedFile) => {
          console.log('SLECTED FILE'+selectedFile)
             
    try {
        const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable', {
         method: 'POST',
          headers: {
            "Authorization": `Bearer ${localStorage.getItem('b_token')}`,
            "Content-Type": "application/json; charset=UTF-8"
          },
          body: JSON.stringify({ name:`LESS${selectedFile.name}`, mimeType:selectedFile.type, parents:localStorage.getItem('folder_id')})
         });
       
         const header_res = await response.headers.get('location'); 
         let status = await response.status
         localStorage.setItem('loc_url', header_res)
         
         if(header_res != null){
            uploadfile(header_res, selectedFile)
         }

      } 
      catch(error) {
          console.log(error)
      } 
}
// END FUNCTION

    const uploadfile = async (header_res, selectedFile, range = null) => {
     // alert(range)
      if (selectedFile) {
        // Create a new FileReader
        const fileReader = new FileReader();
    
        // Define an event handler for when the file is loaded
        fileReader.onload = function (event) {
            let chunkIndex = ''
            // Access the file data as an ArrayBuffer
            const arrayBuffer = event.target.result;
    
            // Convert the ArrayBuffer to a Uint8Array
            const uint8Array = new Uint8Array(arrayBuffer);
    
            // Get a chunk of 256KB from the Uint8Array
            const chunkSize = 256 * 1024; // 200KB
            // Initialize variables for tracking chunk index and total chunks

            if(range !== null){
               chunkIndex = localStorage.getItem('chunkIndex');
            }else{
               chunkIndex = 0;
            }
            

            const totalChunks = Math.ceil(uint8Array.length / chunkSize);
    
            
            async function uploadLessThan(range = null){
              
              const totalSize_ = uint8Array.length;
              let chunk_ = '';
              //console.log(`the chunk is ${chunk_}`)

                let _start = ''
         
                if(range != null){
                  console.log('range is present')
                  _start = Number(range)+1
                  console.log(_start)
                  chunk_ = uint8Array.slice(_start, uint8Array.length);
                }else{
                  _start = 0
                  chunk_ = uint8Array
                }


     
                // Step 2: Upload the file
                const uploadFile = async (header_res) => {
                
                  alert(localStorage.getItem('folder_id'))
                    const response = await axios(
                      {
                        method: "PUT",
                        url: header_res,
                        headers: {
                          'Content-Range': `bytes ${_start}-${totalSize_ - 1}/${totalSize_}`,
                          'Content-Type': selectedFile.type, // Specify the MIME type
                        },
                        data: chunk_,
                        onUploadProgress: (progressEvent) => {
                          if(range != null){
    
                            console.log('totalsize'+totalSize_)
                            let new_load = (progressEvent.loaded + Number(range))
                            let percentCompleted = Math.round((new_load/totalSize_ * 100));
                            $('.prog').text(`${Math.round(percentCompleted)}%`)
             
                            console.log(`Upload Progress: ${percentCompleted}%`);
                            console.log(`File Loaded: ${new_load}`);
                            
                            $('.progress_bar').removeClass('bg-green-500')
                            $('.progress_bar').addClass('is-active')
                            $('.progress_bar').addClass('bg-orange-500')
                            $('#progress_bar_section').show()
                            $('.progress_bar').css('width', `${percentCompleted.toFixed(2)}%`)
                            $('#upload_percentage').text(`${Math.round(percentCompleted)}%`)
                          }else{
                            // Calculate and report the upload progress
                            $('.prog').text(`${Math.round(progressEvent.loaded * 100/progressEvent.total)}%`)
                            let percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);
           
                            console.log(`Upload Progress: ${percentCompleted}%`);
                            console.log(`File Loaded: ${progressEvent.loaded }`);
                            
                            $('.progress_bar').removeClass('bg-green-500')
                            $('.progress_bar').addClass('is-active')
                            $('.progress_bar').addClass('bg-orange-500')
                            $('#progress_bar_section').show()
                            $('#upload_percentage').text(`${Math.round(percentCompleted)}%`)
                            $('.progress_bar').css('width', `${percentCompleted.toFixed(2)}%`)
                          }
                             
                        }
                      })                
                        .then((response) => {
                          // Handle a successful response here
                          console.log('Response data:', response.data);
                          console.log('Response data:', response.status);
                          if(response.status == 200){
                            
                              
                              $('.progress_bar').removeClass('bg-orange-500')
                              $('.progress_bar').removeClass('bg-warning')
                              $('.progress_bar').removeClass('is-active')
                              $('.progress_bar').addClass('bg-green-500')
                            
                          }
                          gogetMetadata(response.data)
                        })
                        .catch((error) => {
                          if (error.response) {
                          
                            // The request was made and the server responded with a non-2xx status code
                            console.log('Error response status:', error.response.status);
                            console.log('Error response data:', error.response.data);
                          } else if (error.request) {
                            // The request was made but no response was received, typically a network issue
                            console.error('Network issue:', error.request);
                            checkResume(header_res, totalSize_)
                          } else {
                            // Something happened in setting up the request or during the request
                            console.error('Request error:', error.message);
                          }
                        });
                  
                      }
                  
                uploadFile(header_res)  
            }          
      
            async function uploadNextChunk(range = null) {
              if(range != null){
               
                chunkStart = range+1;
                chunkEnd = Math.min(start + chunkSize, uint8Array.length);
              
              }else{
              
                 chunkStart = start;
                 chunkEnd = end - 1;
              }
             
                  const totalSize = uint8Array.length;
                  const headers = {
                      'Content-Range': `bytes ${chunkStart}-${chunkEnd}/${totalSize}`,
                      'Content-Length': `${end - start}`,
                      'Content-Type': selectedFile.type, // Specify the MIME type
                  };
                  console.log(selectedFile.type)
              try {
                  const response = await fetch(header_res, {
                      method: 'PUT',
                      headers: headers,
                      body: chunk,
                  });
                  let sta = await response.status
                 
           
          
                  
                  if (response.status === 200) {
                 
                    const res = await response.json();
                    console.log(res);
                    console.log(res.id); 
                     localStorage.setItem('loc_url', null)
                      updateProgressBar('complete');
                      console.log('Upload complete');
                      console.log('Success: you can now update records to table field  ');
                      // UNSET MOST LOCALSTORAGE
                      gogetMetadata(res)
                      return
                     
                  }
                  if (response.status === 308) {
                      console.log(`Uploaded chunk ${chunkIndex + 1} of ${totalChunks}`);
                      chunkIndex++;
                      updateProgressBar();
          
                      if (chunkIndex < totalChunks) {
                          uploadNextChunk();
                      } else {
                          console.log('Upload complete');
                      }
                  } else {
                      console.error(`Failed to upload chunk ${chunkIndex + 1}. Status: ${response.status}`);
                  }
              } catch (error) {
                $('.offline').show()
                $('.offline span').html('Your offline, dont leave this page')
                if(localStorage.getItem('chunk_status') > 0 && localStorage.getItem('chunk_status') < 100){
                  checkResume()
                }
                 
                  console.error(`Error uploading chunk: ${error}`);
              }
          }


            async function gogetMetadata(res){
              // Assuming you have authenticated and obtained an access token
              const accessToken = localStorage.getItem('b_token'); // Replace with your actual access token
              const fileId = res.id; // Replace with the actual file ID

              // Make a request to fetch the file's metadata, including webViewLink
              const webLink = `https://www.googleapis.com/drive/v3/files/${fileId}?fields=webViewLink`;
              const webContent = `https://www.googleapis.com/drive/v3/files/${fileId}?fields=webContentLink`;
              try {
                const linkResponse = await fetch(webLink, {
                  method: 'GET',
                  headers: {
                    'Authorization': `Bearer ${accessToken}`,
                    'Accept': 'application/json',
                  },
          
              });
              let link = await linkResponse.json()
              console.log(link.webViewLink)
            }
              catch(error) {
              console.error('Error fetching wbviewLink:', error);
            }

            try{
              const linkContent =await  fetch(webContent, {
                method: 'GET',
                headers: {
                  'Authorization': `Bearer ${accessToken}`,
                  'Accept': 'application/json',
                },
            });
            
            let content = await linkContent.json()
            console.log(content.webContentLink)
            console.log(content)
            }
            catch(error) {
              console.error('Error fetching webViewContent:', error);
            }
              

          }
           
            // Function to update the progress bar and text
            function updateProgressBar(complete = null) {
              let percentComplete = ''
              
              if(complete == 'complete'){
    
                percentComplete = 100
                localStorage.setItem('chunk_status', percentComplete)
                console.log(`${percentComplete.toFixed(2)}%`)
                $('#progressText').text(`${percentComplete.toFixed(2)}%`);
                $('#upload_percentage').text(`${percentComplete}%`)
                $('.progress_bar').removeClass('is-active')
                $('.progress_bar').removeClass('bg-warning')
                $('.progress_bar').addClass('bg-green-500')
                $('.progress_bar').css('width', `${percentComplete.toFixed(2)}%`)
              }else{
                  percentComplete =(chunkIndex / totalChunks) * 100;
                  localStorage.setItem('chunk_status', percentComplete)
                  $('.progress_bar').addClass('is-active')
                  $('.progress_bar').addClass('bg-warning')
                  $('.progress_bar').removeClass('bg-green-500')
                  $('#progress_bar_section').show()
                  $('#upload_percentage').text(`${percentComplete}%`)
                  $('#progressBar').val(percentComplete);
                  $('#progressText').text(`${percentComplete.toFixed(2)}%`);
                  $('.progress_bar').css('width', `${percentComplete.toFixed(2)}%`)
                  console.log(`${percentComplete.toFixed(2)}%`)
                }
              }


            // Check if file size is less than 256 of equal to 256 kb
            console.log(uint8Array.length )
            if(uint8Array.length >= (1024)){
              console.log('less thank')
              uploadLessThan(range)
            }

        };
    
        // Read the file as an ArrayBuffer
        fileReader.readAsArrayBuffer(selectedFile);
      }
    }
    getlocations(selectedFile)
  }
</script>

<script>

  function hasMultipleNames(nameToVerify) {
    // Split the input string by space
    const names = nameToVerify.split(' ');
  
    // Check if the array has more than one element
    return names.length > 1;
  }

  function isValidEmail(email) {
    // Regular expression for a basic email format
    const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
  
    return emailRegex.test(email);
  }

  // handle Image alternation
  function next(){
    if($('#upload_email').val() == ''){
      $('#up_email_err').text('Email field is required')
      
    }else{
      $('#up_email_err').text('')
    }
    if($('#upload_name').val() == ''){
      $('#up_name_err').text('Name field is required')
      return
    }else{
      $('#up_name_err').text('')
    }
   

      // VERIFY EMAIL ADDRESS
      const emailToVerify = $('#upload_email').val();
      if (isValidEmail(emailToVerify)) {
 
      } else {
        $('#up_email_err').text(`${emailToVerify} is not a valid email address.`)
        return;
      }

      //VERIFY NAME 
      const nameToVerify = $('#upload_name').val(); // Replace with the input you want to check

      if (hasMultipleNames(nameToVerify)) {
        console.log(`The input "${nameToVerify}" .`);
      } else {
        $('#up_email_err').text(`Please input your first and last name.`)
        return;
      }


      $('#up_name_err').text('')
      $('#up_email_err').text('')

      // HIDE AND SHOW SECTIONS
      $('#image_section').show()
      $('#next_section').hide()
      $('#upload_button').show()
      $('#next_section').hide()
    }

  
</script>

<script>
  $(document).ready(function() {
    //REPLACE ID IN URL
    
    let url_params = new URLSearchParams(window.location.search)
    console.log(url_params.get('id'))

    if(url_params == null || url_params == ''){
      
    }

    async function open(url_params){
      
    let settings = {
      method: 'GET',
    };
  
    console.log(settings)
    try {
      let fetchRecord = await fetch(`http://localhost:5000/api/app/getrecordbyidnoauth/${url_params.get('id')}`, settings);
      let fetchSettings = await fetch(`http://localhost:5000/api/app/getsettingbyidnoauth/${url_params.get('id')}`, settings);
      let statuz = await fetchRecord.status
      let record = await fetchRecord.json();
      let set = await fetchSettings.json();
      console.log(record);
      console.log(set);
      console.log('folder_id'+ record.data.folder)
      localStorage.setItem('b_token', set.token)
      localStorage.setItem('folder_id', record.data.folder)
      if(statuz == 700){
        $('#upload_title').text('Link Expired')
       // window.location.href = `http://127.0.0.1:5502/dist/auth/signin.html`
      }else{
       
      }

      // make use of settings details
      if(set.ask_name == 'true'){

      }
      if(set.send_notification == 'true'){
        
      }
      // QUANTITY SETTINGS
      if(set.quantity == 'multiple_files'){
        
      }else if(set.quantity == 'multiple_files'){

      }else{
       
      }
      // UPLOAD SIZE SETTINGS
      if(set.upload_size == 'any_size'){
        
      }else if(set.upload_size == 'custom'){
        
      }else{

      }

      if(set.file_type == 'true'){

      }
 
      /*
      const inputString = "John,Doe,30";

      // Split the string into an array using a comma as the delimiter
      const parts = inputString.split(',');

      // Count how many parts were generated
      const numberOfParts = parts.length;

      // Assign the array elements to variables
      const firstName = parts[0];
      const lastName = parts[1];
      const age = parseInt(parts[2]); // Convert age to an integer

      console.log("First Name:", firstName);
      console.log("Last Name:", lastName);
      console.log("Age:", age);
      */

 
      if(record.error == 2){
          window.location.href = "/dist/auth/signin.html";  
      }
      if(record.status == 200){
        $('#upload_title').html(`<span class="capitalize">${record.data.record_name}</span>`)
        $('#upload_description').text(record.data.description)
       // $('#upload_title').text(record.data.record_name)
          //console.log(json.data)
          //window.location.href = "/dist/dashboard/share.html";        
        }else{
            console.log('Going to chunk 2')
            
  
        }
      } catch (e) {
          // WHEN BACKEND HANDLES NO URL ID
          console.log('hmm')
          console.log(e);
      } 
    }
    open(url_params)
  }) 
</script>



<script>
  function connection(){

    if(window.navigator.onLine == true){
      console.log('you are online')
     }else{
      console.log('you are offline')
     }
     window.addEventListener("online", function() {
      console.log("I am connected to the internet")
    })
    
    window.addEventListener("offline", function() {
      console.log("Disconnected...so sad!!!")
    })
  }


</script>
<!-- <script>
  $(document).ready(function() {

    let fullurl = window.location.href
    let id = fullurl.substr(fullurl.length - 9) 
  
  
    async function open(){
      
    let settings = {
      method: 'GET',
      headers: {
        "Content-Type": "application/json; charset=UTF-8"
      }
     
    };
  
    console.log(settings)
    try {
      let fetchResponses = await fetch(`http://localhost:5000/api/users/getforupload/${id}`, settings);
      let stta = await fetchResponses.status
      let json = await fetchResponses.json();
      console.log(json);
 
    
      if(stta == 200){
          //alert('uploaded successfully')
         // window.location.href = "/dist/dashboard/share.html";  
        $('.up_title').text(json.data.name)
        $('.up_desc').text(json.data.description)
          
        }else{
            console.log('Going to chunk 2')
            
        }
      } catch (e) {
          console.log(e);
      } 
    }
    open()
  }) 
</script> -->